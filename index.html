<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Configuración</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>Generador de aplicaciones</h1>
            <p>Complete los pasos para generar su complemento</p>
        </header>

        <!-- Stepper -->
        <div class="stepper-container">
            <div class="stepper">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Formulario</div>
                </div>
                <div class="step-line"></div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Generación</div>
                </div>
                <div class="step-line"></div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">Migración</div>
                </div>
                <div class="step-line"></div>
                <div class="step" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-label">Exportación</div>
                </div>
            </div>
        </div>

        <!-- Paso 1: Formulario -->
        <div id="step1" class="step-content active">
            <form id="configForm">
                <div class="form-section">
                    <h2>Configuración de client</h2>

                    <div class="form-group">
                        <label for="client_id">Client ID:</label>
                        <input type="text" id="client_id" name="client_id" placeholder="Ingrese client_id">
                    </div>

                    <div class="form-group">
                        <label for="license">License:</label>
                        <input type="text" id="license" name="license" placeholder="Ingrese license">
                    </div>

                    <div class="form-group">
                        <label for="client_redirect_uri">Redirect URI:</label>
                        <input type="text" id="client_redirect_uri" name="client_redirect_uri"
                            placeholder="Ingrese client_redirect_uri">
                    </div>

                    <div class="form-group">
                        <label for="company_logo">Company Logo:</label>
                        <input type="file" id="company_logo" name="company_logo" accept="image/*" required>
                        <small>Subir archivo de imagen (SVG, PNG, JPG, etc.) que se usará para generar todas las
                            imágenes del icono</small>
                    </div>

                    <div class="form-group">
                        <label for="primary_color">Primary Color:</label>
                        <div class="color-input-group">
                            <input type="text" id="primary_color" name="primary_color" value="0xFFFE5000"
                                placeholder="0xFFFE5000">
                            <input type="color" id="primary_colorPicker" value="#FE5000" class="color-picker">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="secure_flag" class="secure-flag-label">
                            <span><input type="checkbox" id="secure_flag" name="secure_flag">Seguridad extrema (cambios
                                biométricos resetean el enrollment)</span>
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="environment">Environment:</label>
                        <select id="environment" name="environment">
                            <option value="PRO">PRO</option>
                            <option value="SB">SB</option>
                            <option value="DEV">DEV</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="name">Name:</label>
                        <input type="text" id="name" name="name" placeholder="Ingrese name" required>
                    </div>

                    <div class="form-group">
                        <label for="applicationId">Application ID:</label>
                        <input type="text" id="applicationId" name="applicationId" placeholder="Ingrese applicationId">
                    </div>

                    <div class="form-group">
                        <label for="versionCode">Version Code:</label>
                        <input type="number" id="versionCode" name="versionCode" value="1" min="1">
                    </div>

                    <div class="form-group">
                        <label for="versionName">Version Name:</label>
                        <input type="text" id="versionName" name="versionName" value="1.0.0" placeholder="1.0.0">
                    </div>
                </div>

                <div class="form-section">
                    <h2>Configuración Android</h2>

                    <div class="form-group">
                        <label for="fillColor">Fill Color (ic_launcher_background.xml):</label>
                        <div class="color-input-group">
                            <input type="text" id="fillColor" name="fillColor" value="#0D75A1" placeholder="#0D75A1">
                            <input type="color" id="fillColorPicker" value="#0D75A1" class="color-picker">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="ic_launcher_background_color">Color (colors.xml):</label>
                        <div class="color-input-group">
                            <input type="text" id="ic_launcher_background_color" name="ic_launcher_background_color"
                                value="#FE5000" placeholder="#FE5000">
                            <input type="color" id="ic_launcher_background_colorPicker" value="#FE5000"
                                class="color-picker">
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" id="generateBtn" class="btn-primary">Generar recursos</button>
                </div>
            </form>
        </div>

        <!-- Paso 2: Generación de recursos -->
        <div id="step2" class="step-content">
            <div class="step-header">
                <h2>Generación de recursos</h2>
                <p>Los recursos se han generado correctamente, verifique si son correctos y proceda a la migración</p>
            </div>

            <div class="preview-content">
                <div class="icon-preview">
                    <h3 id="projectName"></h3>
                    <div class="icon-container">
                        <img id="iconPreview" alt="Icono del proyecto">
                    </div>
                </div>

                <div class="screenshots-gallery" visible="false">
                    <h3>Screenshots</h3>
                    <div class="screenshots-row">
                        <img id="screenshot1Preview" src="../screenshots/screenshot_1.png" alt="Screenshot 1"
                            class="screenshot">
                        <img src="../screenshots/screenshot_2.png" alt="Screenshot 2" class="screenshot">
                        <img src="../screenshots/screenshot_3.png" alt="Screenshot 3" class="screenshot">
                        <img src="../screenshots/screenshot_4.png" alt="Screenshot 4" class="screenshot">
                    </div>
                </div>

                <div class="preview-actions">
                    <button id="copyResourcesBtn" class="btn-primary">Copiar recursos</button>
                    <button id="downloadBtn" class="btn-secondary">Descargar ZIP</button>
                </div>
            </div>
        </div>

        <!-- Paso 3: Copiar recursos -->
        <div id="step3" class="step-content">
            <div class="step-header">
                <h2>Copiar recursos</h2>
            </div>
            <div class="info-box">
                <p>Este proceso realiza una llamada a Jenkins que ejecuta el siguiente comando:</p>
                <div class="code-block">
                    <code>:composeApp:importClientConfig -Pclient=<span id="clientNameStep3"></span></code>
                </div>
                <p>Este comando incorpora la configuración del cliente al proyecto.</p>
            </div>
            <div class="preview-actions">
                <button id="executeCopyBtn" class="btn-primary">Ejecutar copia de recursos</button>
                <button id="backToStep2Btn" class="btn-secondary">Volver</button>
            </div>
        </div>

        <!-- Paso 4: Generar aplicación -->
        <div id="step4" class="step-content">
            <div class="step-header">
                <h2>Generar aplicación</h2>
            </div>
            <div class="info-box">
                <p>Este paso ejecuta la compilación y generación de APKs mediante Jenkins con el siguiente comando:</p>
                <div class="code-block">
                    <code>:composeApp:buildClientBundle -Pclient=<span id="clientNameStep4"></span></code>
                </div>
                <p>Este proceso compila la aplicación y genera los archivos APK correspondientes.</p>
            </div>
            <div class="preview-actions">
                <button id="executeBuildBtn" class="btn-primary">Generar aplicación</button>
                <button id="backToStep3Btn" class="btn-secondary">Volver</button>
            </div>
        </div>


        <div id="loadingOverlay" class="loading-overlay hidden">
            <div class="spinner"></div>
            <p>Generando proyecto...</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="app.js"></script>
</body>

</html>